
From es@noos.kiev.ua Fri Sep  5 14:08:13 1997
Date: Fri, 05 Sep 97 09:53:56 +0300
From: es@noos.kiev.ua
To: dip <dip@lab321.ru>
Subject: Re: SysBar/2

Hi!

>OK. Send it. I'll try to fix it.

Some comments to code: because thy was combined
from many pieces written in different time you may
find some difference in style. I hope this will not
make many problems for you. Exception handler in main
routine is important, because sometimes program can generate
strange access violation exceptions (I don't know exactly why).
As you can see in source this exception can not be generated by
program itself. May be this exception caused by using DosQuerySysState call
(they are not documented).

Regards,
    Sergey.

* "Ich bin gumanist! Ich liebe dich ... essen!"
------------------------------------------------------------
Sergey I. Yevtushenko 
Internet:es@noos.kiev.ua
FIDO: 2:463/114.69@fidonet

begin 666 cpuload.RAR
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
5\\7/EG*0W-'BGW4:?>?\^X71````
`
end

